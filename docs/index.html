<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PolyWeave Mines</title>
  <link rel="stylesheet" href="style.css">
</head>
<body data-theme="dark-ocean" class="no-select">
  <div class="controls" role="region" aria-label="Game controls">
    <div class="control-group">
      <label for="msRows">Rows</label>
      <input id="msRows" type="number" min="3" max="240" value="12" />
    </div>

    <div class="control-group">
      <label for="msCols">Cols</label>
      <input id="msCols" type="number" min="3" max="240" value="16" />
    </div>

    <div class="control-group">
      <label for="msMines">Mines</label>
      <input id="msMines" type="number" min="1" value="40" />
    </div>

    <div class="control-group">
      <label for="adjacencySelect">Adjacency</label>
      <select id="adjacencySelect" aria-label="Adjacency">
        <option value="all8" selected>All (8)</option>
        <option value="edges4">Edges (4)</option>
      </select>
      <button id="deleteAdj" class="ms-btn" style="display:none; margin-left:8px;">Ã—</button>
    </div>

    <div class="control-group">
      <label for="themeSelect">Theme</label>
      <select id="themeSelect" aria-label="Theme">
        <option value="dark-ocean">Dark Ocean</option>
        <option value="solarized-dark">Solarized Dark</option>
        <option value="nord">Nord</option>
        <option value="gruvbox">Gruvbox</option>
        <option value="dracula">Dracula</option>
        <option value="high-contrast">High Contrast</option>
        <option value="soft-light">Soft Light</option>
        <option value="slate">Slate</option>
      </select>
    </div>

    <div class="control-group mobile-only">
      <button id="flagMode" class="ms-btn" aria-pressed="false">ðŸš© Flag</button>
    </div>

    <div style="margin-left:auto; display:flex; gap:8px; align-items:center;">
      <div id="msStatus">Ready</div>
      <div id="msTimer">0:00</div>
      <button id="openAdjEditor" class="ms-btn">Adjacency Editor</button>
      <button id="copyGame" class="ms-btn">Copy</button>
      <button id="pasteGame" class="ms-btn">Paste</button>
      <button id="newGame" class="ms-btn primary">New Game</button>
    </div>
  </div>

  <main id="appRoot" role="main" aria-live="polite">
    <div class="minefield-window" id="minefieldWindow">
      <div class="minefield-shell" id="minefieldShell">
        <div class="minefield-frame" id="minefieldFrame" tabindex="0">
          <div class="minefield-container" id="minefieldContainer" tabindex="0" aria-label="Minefield. Drag frame to pan, pinch/trackpad/ctrl+wheel or wheel to zoom.">
            <svg id="minefieldSvg" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMinYMin meet"></svg>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Adjacency Editor Modal -->
  <div id="adjModal" class="modal" aria-hidden="true" role="dialog" aria-label="Adjacency editor">
    <div class="modal-sheet">
      <div class="modal-head">
        <div class="tabs">
          <button class="tab active" data-tab="preview">Preview</button>
          <button class="tab" data-tab="editor">Editor</button>
        </div>
        <button id="closeAdj" class="ms-btn">Close</button>
      </div>

      <div class="modal-body">
        <section id="previewTab" class="tabpane active">
          <div class="preview-controls">
            <label for="previewRows">Rows</label><input id="previewRows" type="number" min="3" max="40" value="9" />
            <label for="previewCols">Cols</label><input id="previewCols" type="number" min="3" max="40" value="9" />
            <label for="previewMines">Mines</label><input id="previewMines" type="number" min="1" value="10" />
            <button id="previewStart" class="ms-btn">Start Preview</button>
          </div>
          <div id="previewArea" class="editor-grid-wrap"></div>
        </section>

        <section id="editorTab" class="tabpane">
          <div class="editor-grid-wrap">
            <div id="editorGrid" class="editor-grid" aria-hidden="false"></div>
          </div>

          <div class="editor-controls">
            <div>Click cells to toggle adjacency (center is bomb)</div>
            <div class="editor-btns">
              <button id="clearAdj" class="ms-btn">Clear</button>
              <button id="saveAdj" class="ms-btn primary">Save</button>
              <input id="adjName" type="text" placeholder="pattern name" />
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <!-- Paste / Import dialog -->
  <div id="pasteModal" class="modal" aria-hidden="true">
    <div class="modal-sheet small">
      <div class="modal-head"><h3>Paste Game Code</h3><button id="closePaste" class="ms-btn">Close</button></div>
      <div class="modal-body">
        <textarea id="pasteInput" placeholder="Paste game code here" rows="6"></textarea>
        <div style="display:flex; gap:8px; justify-content:flex-end; margin-top:8px;">
          <button id="importBtn" class="ms-btn primary">Import</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Win overlay -->
  <div id="winOverlay" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); z-index:300; align-items:center; justify-content:center;">
    <div class="win-sheet" style="background:var(--panel); padding:28px; border-radius:12px; text-align:center; min-width:260px;">
      <h2 class="win-title" style="margin:0 0 8px;">ðŸŽ‰ You Win! ðŸŽ‰</h2>
      <div id="winTime" class="win-sub" style="margin-bottom:12px;"></div>
      <div style="display:flex; gap:8px; justify-content:center;">
        <button id="winClose" class="ms-btn primary">Close</button>
        <button id="winNew" class="ms-btn">New Game</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
