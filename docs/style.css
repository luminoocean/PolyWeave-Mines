/* style.css
   Simple reveal animation, shorter hover, theme-driven colors,
   no stroke for revealed tiles (merged look), subtle ripple.
*/

:root{
  --transition-fast: 120ms cubic-bezier(.2,.9,.2,1);
  --transition-med: 200ms cubic-bezier(.2,.9,.2,1);

  /* fallback */
  --bg-0: #071021;
  --panel: linear-gradient(180deg,#091422,#071021);
  --accent: #3ec7ff;
  --text: #dcefff;
  --sub: #9fb4c8;
  --input-bg: rgba(255,255,255,0.03);
  --input-text: var(--text);

  --tile-hidden-fill: rgba(2,10,20,0.9);
  --tile-hidden-stroke: rgba(255,255,255,0.06);

  --tile-revealed-fill: rgba(14,28,38,0.94);
  --tile-revealed-stroke: transparent; /* NO visible border between revealed tiles */
  --ripple-color: rgba(255,255,255,0.06);
}

/* Themes */
body[data-theme="dark-ocean"]{
  --bg-0:#071021; --panel:linear-gradient(180deg,#091422,#071021);
  --accent:#3ec7ff; --text:#dcefff; --sub:#9fb4c8; --input-bg:rgba(255,255,255,0.03); --input-text:var(--text);
  --tile-hidden-fill: rgba(2,10,20,0.9);
  --tile-revealed-fill: rgba(12,26,36,0.94);
}
body[data-theme="solarized-dark"]{
  --bg-0:#002b36; --panel:linear-gradient(180deg,#073642,#002b36);
  --accent:#b58900; --text:#eee8d5; --sub:#93a1a1; --input-bg:rgba(255,255,255,0.02); --input-text:var(--text);
  --tile-hidden-fill: rgba(6,34,36,0.92);
  --tile-revealed-fill: rgba(10,44,46,0.95);
}
body[data-theme="nord"]{
  --bg-0:#2e3440; --panel:linear-gradient(180deg,#3b4252,#2e3440);
  --accent:#88c0d0; --text:#e5e9f0; --sub:#94a3b8; --input-bg:rgba(255,255,255,0.02); --input-text:var(--text);
  --tile-hidden-fill: rgba(12,18,28,0.92);
  --tile-revealed-fill: rgba(22,32,48,0.95);
}
body[data-theme="gruvbox"]{
  --bg-0:#282828; --panel:linear-gradient(180deg,#3c3836,#282828);
  --accent:#fabd2f; --text:#ebdbb2; --sub:#bdae93; --input-bg:rgba(255,255,255,0.02); --input-text:var(--text);
  --tile-hidden-fill: rgba(36,30,26,0.92);
  --tile-revealed-fill: rgba(54,48,44,0.95);
}
body[data-theme="dracula"]{
  --bg-0:#282a36; --panel:linear-gradient(180deg,#3b3d4a,#282a36);
  --accent:#ff79c6; --text:#f8f8f2; --sub:#bfb8d8; --input-bg:rgba(255,255,255,0.02); --input-text:var(--text);
  --tile-hidden-fill: rgba(32,34,46,0.9);
  --tile-revealed-fill: rgba(60,62,80,0.95);
}
body[data-theme="high-contrast"]{
  --bg-0:#000000; --panel:linear-gradient(180deg,#111111,#000000);
  --accent:#00ffb3; --text:#ffffff; --sub:#bfbfbf; --input-bg:rgba(255,255,255,0.02); --input-text:var(--text);
  --tile-hidden-fill: rgba(0,0,0,0.96);
  --tile-revealed-fill: rgba(28,28,28,0.96);
}
body[data-theme="soft-light"]{
  --bg-0:#f5f7fa; --panel:linear-gradient(180deg,#ffffff,#f5f7fa);
  --accent:#2b6cb0; --text:#0b2540; --sub:#4a6572; --input-bg:#ffffff; --input-text:#0b2540;
  --tile-hidden-fill: rgba(249,250,252,0.98);
  --tile-revealed-fill: rgba(243,245,247,0.98);
}
body[data-theme="slate"]{
  --bg-0:#0f1724; --panel:linear-gradient(180deg,#111827,#0f1724);
  --accent:#60a5fa; --text:#e6eef8; --sub:#9fb4c8; --input-bg:rgba(255,255,255,0.02); --input-text:var(--text);
  --tile-hidden-fill: rgba(10,16,26,0.92);
  --tile-revealed-fill: rgba(14,20,34,0.95);
}

/* Layout */
body{ margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial; background:var(--bg-0); color:var(--text); height:100vh; display:flex; flex-direction:column; transition: background var(--transition-med), color var(--transition-med); }
.no-select{ -webkit-user-select:none; -ms-user-select:none; user-select:none; }

.controls{ display:flex; gap:12px; padding:12px; align-items:center; background:var(--panel); box-shadow:0 6px 18px rgba(0,0,0,0.35); }
.control-group{ display:flex; gap:6px; align-items:center; }

input[type="number"], input[type="text"], textarea, select{ background: var(--input-bg); color: var(--input-text); border: 1px solid rgba(255,255,255,0.04); padding:6px 8px; border-radius:6px; outline:none; transition: box-shadow var(--transition-fast), border-color var(--transition-fast); }
input[type="number"]:focus, input[type="text"]:focus, textarea:focus, select:focus{ box-shadow: 0 6px 18px rgba(0,0,0,0.18); border-color: rgba(255,255,255,0.08); }

.ms-btn{ background:transparent; color:var(--text); border:1px solid rgba(255,255,255,0.04); padding:6px 10px; border-radius:6px; cursor:pointer; transition: transform var(--transition-fast), background var(--transition-fast); }
.ms-btn.primary{ background: linear-gradient(180deg,var(--accent), color-mix(in srgb, var(--accent) 70%, black 20%)); color: #071021; border:none; }
.ms-btn:active{ transform:translateY(1px) scale(0.997); }
#msStatus{ padding:6px 8px; border-radius:6px; background: rgba(255,255,255,0.02); color:var(--sub); }
#msTimer{ padding:6px 8px; border-radius:6px; background: rgba(255,255,255,0.02); color:var(--accent); min-width:48px; text-align:center; }

/* Minefield */
.minefield-window{ padding:12px; display:flex; justify-content:center; flex:1; }
.minefield-frame{ width:100%; max-width:1100px; height:calc(100vh - 160px); background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent); border-radius:10px; overflow:hidden; position:relative; outline:none; }
.minefield-container{ width:100%; height:100%; transform-origin:center center; transition: transform var(--transition-med) ease; }

/* SVG tiles */
svg{ width:100%; height:100%; display:block; user-select:none; -webkit-user-select:none; }

/* default hidden tile */
svg polygon{
  fill: var(--tile-hidden-fill);
  stroke: rgba(255,255,255,0.06);
  stroke-width: 1.25;
  transition: fill 160ms linear, transform 120ms cubic-bezier(.2,.9,.2,1), opacity 120ms ease;
  transform-origin:center center;
  will-change: transform, fill, opacity;
}

/* hover lift reduced to ~1% */
svg polygon:hover{
  transform: translateY(-1%) scale(1.01);
  filter: drop-shadow(0 6px 12px rgba(0,0,0,0.18));
}

/* revealed tiles: no stroke (merged look) */
svg polygon.revealed{
  fill: var(--tile-revealed-fill);
  stroke: var(--tile-revealed-stroke);
  stroke-width: 0;
  transition: fill 180ms linear;
}

/* text placement */
svg text{
  transition: opacity 140ms ease, transform 140ms ease;
  opacity: 0;
  font-weight:600;
  pointer-events:none;
  font-family: Inter, system-ui, Arial;
}
svg polygon.revealed + text{ opacity: 1; fill: var(--text); filter: drop-shadow(0 1px 0 rgba(0,0,0,0.18)); }

/* flags on hidden tiles visible */
svg polygon:not(.revealed) + text{ opacity: 1; }

/* number pop: only newly revealed number gets class 'pop' from JS */
@keyframes popIn{ 0%{ transform:translateY(6px) scale(0.94); opacity:0 } 60%{ transform:translateY(-2px) scale(1.02); opacity:1 } 100%{ transform:translateY(0) scale(1); opacity:1 } }
svg text.pop{ animation: popIn 260ms cubic-bezier(.2,.9,.2,1); }

/* ripple - subtle border glow applied briefly by JS */
.ripple{
  animation: rippleAnim 420ms ease-out;
  box-shadow: 0 0 0 0 var(--ripple-color);
}
@keyframes rippleAnim{
  0%{ filter: drop-shadow(0 0 0 rgba(0,0,0,0)); transform: scale(1); }
  30%{ transform: scale(1.006); }
  100%{ transform: scale(1); filter: none; }
}

/* flag subtle nudge */
svg .flagging{ transform: scale(1.01); transition: transform 160ms cubic-bezier(.2,.9,.2,1); }
svg text.flagging{ transform: translateY(-2px) scale(1.01); }

/* win subtle */
.win-wave{ animation: winWave 760ms ease-out; }
@keyframes winWave{ 0%{ transform:translateY(-6px) scale(0.995); opacity:0 } 60%{ transform:translateY(0) scale(1.01); opacity:1 } 100%{ transform:translateY(0) scale(1); opacity:1 } }

/* modals/editor */
.modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:400; }
.modal[aria-hidden="false"]{ display:flex; }
.modal-sheet{ background:var(--panel); border-radius:10px; padding:8px; min-width:520px; max-width:90%; color:var(--text); }
.modal-sheet.small{ width:420px; }
.win-sheet{ transition: transform 220ms var(--transition-fast), opacity 180ms ease; }
.win-title{ color:var(--accent); font-size:18px; }
.win-sub{ color:var(--sub); }

/* editor */
.editor-grid{ display:grid; gap:2px; grid-template-columns: repeat(15, 18px); }
.editor-cell{ width:18px; height:18px; background:rgba(255,255,255,0.02); border-radius:4px; display:flex; align-items:center; justify-content:center; cursor:pointer; transition: background 120ms ease, transform 120ms ease; }
.editor-cell.on{ background:var(--accent); transform:scale(1.04); color:#06121a; }
.editor-centre{ background:rgba(255,255,255,0.03); }

/* responsive */
@media (max-width:800px){ .controls{ flex-wrap:wrap; } .minefield-frame{ height:60vh; } }
